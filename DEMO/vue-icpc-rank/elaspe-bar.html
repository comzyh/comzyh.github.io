<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script type="text/javascript" src="//cdn.bootcss.com/vue/1.0.15/vue.js"></script>
    </head>
    <body >
        <div id="elaspe">
            <elaspebar></elaspebar>    
        </div>
    </body>
    <script type="text/x-template" id="elaspebar-template">
        <div style="width:100%;height:5px;padding: 5px 5px 5px 5px;">
            <div style="width:100%;height:5px;background-color:#eee;position:relative;">
                <div style="background-color:#ccc;height:5px;float: left;" v-bind:style="{ width: percentage + '%' }"></div>
                <span style="display:block;height:13px;width:13px;border: 1px solid black;border-radius: 2px;margin-left: -7.5px;margin-top: -5px;position:absolute;cursor:default;touch-action:none;" v-bind:style="{ backgroundColor: dragBoxColor, left: percentage + '%'}" v-on:mousedown="beginDraging" ondragstart="return false;"></span>
            </div>
        </div>
    </script>
    <script type="text/javascript">
        Vue.config.debug = true;
        Vue.component('elaspebar', {
          template: '#elaspebar-template',
          props: ['length', 'position'],
          data: function() {
            return {
              percentage: 44.5,
              draging: false,
              start_x:0,
              start_y:0,
              start_percentage:0
            };
          },
          computed: {
            dragBoxColor: function() {
              if (this.draging)
                return "#777";
              else
                return "#ccc";
            }
          },
          methods: {
            beginDraging: function(event) {
              console.log("beginDraging", event);
              this.draging=true;
              this.start_x = event.pageX;
              this.start_y = event.pageY;
              this.start_percentage = this.percentage;
              var $this = this;
              var doc_mousemove = function(event) {
                var percentage = $this.start_percentage + (event.pageX - $this.start_x) / $this.$el.children[0].offsetWidth * 100;
                if (percentage < 0)
                  percentage = 0;
                if (percentage > 100)
                  percentage = 100;
                $this.percentage = percentage;
                console.log($this.percentage, event.pageX, event.clientX);  
              };
              var doc_mouseup = function(event) {
                $this.draging = false;
                document.removeEventListener("mousemove", doc_mousemove);
                document.removeEventListener("mouseup", doc_mouseup);
              };
              document.addEventListener("mousemove", doc_mousemove);
              document.addEventListener("mouseup", doc_mouseup);
            }
          }
        });
        var demo = new Vue({
          el: '#elaspe',
          data: {
            treeData: 1
          }
        });
    </script>
</html>